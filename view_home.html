<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?>
    <style>
      /* Home画面専用のセンタリングスタイル */
      .home-container {
        max-width: 800px;        /* 幅を少し拡張 */
        margin: 0 auto;
        padding: 40px 20px;      /* 上下の余白を増加 */
        text-align: center;
      }
      
      .home-section {
        margin-bottom: 40px;     /* セクション間の余白を増加 */
      }
      
      .home-section h3 {
        margin-bottom: 16px;
        font-size: 24px;
        color: #333;
      }
      
      .home-button {
        display: inline-block;
        width: 100%;
        max-width: 320px;
        padding: 20px 24px;
        margin: 8px;
        text-decoration: none;
        background: #fff;
        border: 3px solid #2d87ff;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(45, 135, 255, 0.15);
        transition: all 0.2s ease;
        color: #111;
        font-weight: 700;
        font-size: 18px;
      }
      
      .home-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(45, 135, 255, 0.25);
        background: #f8f9fb;
      }
      
      .home-button-icon {
        display: inline-block;
        background: #2d87ff;
        color: #fff;
        padding: 8px 12px;
        border-radius: 8px;
        font-weight: 800;
        font-size: 16px;
        margin-right: 12px;
        min-width: 60px;
        text-align: center;
      }
      
      .company-title {
        margin-bottom: 60px;     /* タイトル下の余白を増加 */
      }
    </style>
  </head>
  <body>
    <div class="home-container">
      <!-- お知らせセクション -->
      <div class="news-section">
        <h2 class="news-title">お知らせ</h2>
        <ul class="news-list" id="newsList">
          <!-- ニュース項目はJavaScriptで動的に生成 -->
          <li class="news-item">
            <span class="news-date">読み込み中...</span>
            <span class="news-content"></span>
          </li>
        </ul>
      </div>

      <!-- 生徒用ページ -->
      <div class="home-section">
        <a class="home-button" href="<?= getAppUrl() ?>?page=students">
          <span class="home-button-icon">STU</span>
          <span>生徒ページへ</span>
        </a>
      </div>

      <!-- 従業員用ページ -->
      <div class="home-section">
        <a class="home-button" href="<?= getAppUrl() ?>?page=employees">
          <span class="home-button-icon">EMP</span>
          <span>従業員ページへ</span>
        </a>
      </div>

      <!-- 塾長ページ -->
      <div class="home-section">
        <a class="home-button" href="<?= getAppUrl() ?>?page=admin&from=home">
          <span class="home-button-icon">ADM</span>
          <span>塾長ページへ</span>
        </a>
      </div>
    </div>
    
    <script>
      // ページ読み込み時にお知らせを取得
      window.addEventListener('load', function() {
        google.script.run.withSuccessHandler(displayNews).getRecentNews();
      });
      
      // お知らせを表示する関数
      function displayNews(newsData) {
        var newsList = document.getElementById('newsList');
        
        if (!newsData || newsData.length === 0) {
          newsList.innerHTML = '<li class="news-item"><span class="news-content">現在お知らせはありません。</span></li>';
          return;
        }
        
        var html = '';
        for (var i = 0; i < newsData.length; i++) {
          var news = newsData[i];
          html += '<li class="news-item">';
          html += '<span class="news-date">' + news.date + '</span>';
          html += '<span class="news-content">' + news.content + '</span>';
          html += '</li>';
        }
        
        newsList.innerHTML = html;
      }
    </script>
  </body>
</html>
